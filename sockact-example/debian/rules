#!/usr/bin/make -f

ARCH ?= $(DEB_HOST_ARCH)

ifeq ($(ARCH),amd64)
  PRESET = amd64-Release
else ifeq ($(ARCH),arm64)
  PRESET = arm64-Release
else
  $(error Unsupported architecture: $(ARCH))
endif

BUILDDIR = build/$(PRESET)

%:
	dh $@ --buildsystem=cmake+ninja --builddirectory=$(BUILDDIR)

override_dh_auto_configure:
	dh_auto_configure --builddirectory=$(BUILDDIR) -- \
	  --preset=$(PRESET) \
	  -DCMAKE_INSTALL_PREFIX=/usr

override_dh_auto_test:
	dh_auto_test

